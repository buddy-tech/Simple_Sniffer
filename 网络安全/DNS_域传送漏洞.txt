Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-12-08T15:45:57+08:00

====== DNS 域传送漏洞 ======
Created Saturday 08 December 2018

===== 背景 =====
Dns 是整个互联网公司业务的基础，目前越来越多的互联网公司开始自己搭建 DNS 服务器做解析服务，同时由于 DNS 服务是基础性服务非常重要，因此很多公司会对 DNS 服务器进行主备配置而 DNS 主备之间的数据同步就会用到 dns 域传送。

===== 危害 =====
恶意用户可以通过 dns 域传送获取被攻击域下所有的子域名。
漏洞可能会导致一些非公开域名（测试域名、内部域名）泄露。而泄露的类似内部域名，其安全性相对较低，更容易遭受攻击者的攻击，比较典型的譬如内部的测试机往往就会缺乏必要的安全设置。

===== 修复 =====
解决域传送问题非常简单，只需要在相应的 zone、options 中添加 allow-transfer 限制可以进行同步的服务器就可以了，可以有两种方式：限制 IP、使用 key 认证。

===== AXFR request =====
AXFR 请求，是从 DNS 服务器请求在主 DNS 服务器上更新信息的一类域名系统的请求。

AXFR 请求经常导致全区域传输。如果区域文件很大的话，它需要花费很多的时间并消耗可观的带宽。

AXFR 的一个可替代选择是 RFC1995 中描述的增量区域传输协议。增量区域传输使用 IXFR 请求仅传输那些被改变的区域文件。
